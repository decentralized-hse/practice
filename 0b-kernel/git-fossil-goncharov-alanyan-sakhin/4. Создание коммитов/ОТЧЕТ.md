# Этап 4: Результаты сравнения операций создания коммитов

## 4.1. Операция: Подготовка изменений (`git add` vs `fossil add`)

**Функциональность:**

**Git `add`:**
- Добавляет содержимое файлов в индекс (staging area)
- Индекс - это промежуточная область между рабочей директорией и репозиторием
- Файлы должны быть явно добавлены в индекс перед коммитом
- Можно добавлять файлы по частям: `git add file1.txt` (только file1.txt)
- Можно добавлять все изменения: `git add .` или `git add -A`
- Изменения в рабочей директории после `git add` не попадают в индекс автоматически - нужно снова выполнить `git add`

**Fossil `add`:**
- Помечает файлы для включения в следующий коммит
- **Нет staging area** - файлы добавляются напрямую к рабочей директории
- Fossil автоматически отслеживает изменения в файлах
- `fossil add` просто помечает файл как "добавить при следующем коммите"
- Изменения в уже отслеживаемых файлах автоматически включаются в коммит

**Ключевое различие: Staging Area**

**Git:**
- Имеет трехступенчатую модель: рабочая директория → индекс (staging) → репозиторий
- Можно подготовить часть изменений для коммита
- Можно проверить, что будет в коммите, перед его созданием
- Индекс позволяет создавать "идеальные" коммиты с точно выбранными изменениями

**Fossil:**
- Имеет двухступенчатую модель: рабочая директория → репозиторий
- Нет промежуточной области для подготовки изменений
- Все изменения в рабочей директории включаются в коммит
- Более простая модель, но менее гибкая для выборочного коммита

**Производительность:**

| Операция | Git `add` | Fossil `add` |
|----------|-----------|--------------|
| Добавление одного файла | 0.001-0.005 сек | 0.001-0.003 сек |
| Добавление множества файлов | Зависит от размера | Зависит от размера |

**Наблюдения:**
- Обе команды выполняются очень быстро
- Git требует больше шагов (add → commit), но дает больше контроля
- Fossil проще в использовании, но менее гибкий

## 4.2. Операция: Просмотр статуса (`git status` vs `fossil status`)

**Функциональность:**

**Git `status`:**
- Показывает состояние рабочей директории относительно индекса и последнего коммита
- Разделяет файлы на категории:
  - **Changes to be committed**: файлы в индексе, готовые к коммиту
  - **Changes not staged for commit**: измененные файлы, не добавленные в индекс
  - **Untracked files**: новые файлы, не отслеживаемые Git
- Показывает текущую ветку
- Может показывать статус относительно удаленного репозитория

**Fossil `status`:**
- Показывает состояние рабочей директории относительно последнего коммита
- Показывает все изменения в рабочей директории:
  - **EDITED**: измененные файлы
  - **ADDED**: новые файлы, помеченные для добавления
  - **DELETED**: удаленные файлы
- Показывает информацию о текущем checkout (коммит, ветка, родитель)
- Нет разделения на "staged" и "unstaged" - все изменения показываются вместе

**Производительность:**

| Операция | Git `status` | Fossil `status` |
|----------|--------------|-----------------|
| Просмотр статуса | 0.010-0.050 сек | 0.005-0.020 сек |

**Наблюдения:**
- Fossil быстрее, так как не нужно проверять индекс
- Git предоставляет больше информации о состоянии файлов
- Git позволяет видеть, что будет в коммите до его создания

## 4.3. Операция: Создание коммитов (`git commit` vs `fossil commit`)

**Функциональность:**

**Git `commit`:**
- Создает коммит из содержимого индекса (staging area)
- Коммитит только файлы, которые были добавлены в индекс через `git add`
- Требует сообщения коммита (через `-m` или редактор)
- Сохраняет метаданные: автор, дата, коммитер, SHA-1 хеш
- Создает ссылку на родительский коммит

**Fossil `commit`:**
- Создает коммит из всех изменений в рабочей директории
- Коммитит все измененные и добавленные файлы автоматически
- Требует сообщения коммита (через `-m` или редактор)
- Сохраняет метаданные: пользователь, дата, UUID (SHA3-256 хеш)
- Создает ссылку на родительский коммит
- Может создавать ветку при коммите: `fossil commit --branch <name> -m "message"`

**Различия в метаданных:**

**Git:**
- **Author**: автор изменений (может отличаться от коммитера)
- **Committer**: кто создал коммит
- **Date**: дата создания коммита
- **SHA-1**: 40-символьный хеш коммита
- **Parent(s)**: ссылка на родительский коммит (один для обычного, два для merge)

**Fossil:**
- **User**: пользователь, создавший коммит
- **Date**: дата создания коммита
- **UUID**: 64-символьный SHA3-256 хеш коммита
- **Parent**: ссылка на родительский коммит
- **Branch**: ветка, к которой принадлежит коммит

**Атомарность операций:**

**Git:**
- Коммит атомарен - либо все файлы из индекса коммитятся, либо ничего
- Можно создать коммит только с частью изменений (только staged files)
- Можно отменить коммит до push: `git reset HEAD~1`

**Fossil:**
- Коммит атомарен - либо все изменения коммитятся, либо ничего
- Все изменения в рабочей директории включаются в коммит
- Можно отменить коммит до sync: `fossil undo`

**Производительность:**

| Операция | Git `commit` | Fossil `commit` |
|----------|--------------|-----------------|
| Создание коммита | 0.010-0.050 сек | 0.010-0.040 сек |

**Наблюдения:**
- Обе команды выполняются быстро
- Git позволяет более точный контроль над содержимым коммита через staging area
- Fossil проще - все изменения коммитятся автоматически
- Производительность сопоставима
